{"openapi":"3.1.0","info":{"title":"Web-comics scroller","description":"Saturday Comics Page brought Online","contact":{"name":"ComicsApi","url":"https://github.com/KKDad/ComicCacher","email":"adrian@gilbert.ca"},"license":{"name":"MIT Licence","url":"https://github.com/thombergs/code-examples/blob/master/LICENSE"},"version":"2.0"},"servers":[{"url":"http://comics.stapledon.local"}],"tags":[{"name":"Update Comics","description":"Update and Cache individual or all configured comics"},{"name":"Retrieval Status","description":"Endpoints for comic retrieval status records"},{"name":"Health","description":"Endpoints for monitoring application health and status"}],"paths":{"/api/v1/users/profile":{"get":{"tags":["user-controller"],"operationId":"getProfile","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUser"}}}}}},"put":{"tags":["user-controller"],"operationId":"updateProfile","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUser"}}}}}}},"/api/v1/users/password":{"put":{"tags":["user-controller"],"operationId":"updatePassword","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringString"}}}}}}},"/api/v1/preferences/display-settings":{"post":{"tags":["preference-controller"],"operationId":"updateDisplaySettings","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUserPreference"}}}}}}},"/api/v1/preferences/comics/{comicId}/lastread":{"post":{"tags":["preference-controller"],"operationId":"updateLastRead","parameters":[{"name":"comicId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUserPreference"}}}}}}},"/api/v1/preferences/comics/{comicId}/favorite":{"post":{"tags":["preference-controller"],"operationId":"addFavorite","parameters":[{"name":"comicId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUserPreference"}}}}}},"delete":{"tags":["preference-controller"],"operationId":"removeFavorite","parameters":[{"name":"comicId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUserPreference"}}}}}}},"/api/v1/comics/{comic}":{"get":{"tags":["comic-controller"],"operationId":"retrieveComicDetails","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseComicItem"}}}}}},"post":{"tags":["comic-controller"],"operationId":"createComicDetails","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComicItem"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseComicItem"}}}}}},"delete":{"tags":["comic-controller"],"operationId":"deleteComicDetails","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK"}}},"patch":{"tags":["comic-controller"],"operationId":"updateComicDetails","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComicItem"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseComicItem"}}}}}}},"/api/v1/auth/validate-token":{"post":{"tags":["auth-controller"],"operationId":"validateToken","parameters":[{"name":"Authorization","in":"header","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseBoolean"}}}}}}},"/api/v1/auth/register":{"post":{"tags":["auth-controller"],"operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegistrationDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseAuthResponse"}}}}}}},"/api/v1/auth/refresh-token":{"post":{"tags":["auth-controller"],"operationId":"refreshToken","requestBody":{"content":{"application/json":{"schema":{"type":"string"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseAuthResponse"}}}}}}},"/api/v1/auth/login":{"post":{"tags":["auth-controller"],"operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseAuthResponse"}}}}}}},"/api/v1/update":{"get":{"tags":["Update Comics"],"operationId":"updateAllComics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseString"}}}}}}},"/api/v1/update/{comicId}":{"get":{"tags":["Update Comics"],"operationId":"updateSpecificComic","parameters":[{"name":"comicId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseString"}}}}}}},"/api/v1/retrieval-status":{"get":{"tags":["Retrieval Status"],"summary":"Get retrieval records with optional filtering","description":"Returns retrieval records from the last 7 days with optional filters. If date parameters are not provided, all available records are returned.","operationId":"getRetrievalRecords","parameters":[{"name":"comicName","in":"query","description":"Filter by comic name","required":false,"schema":{"type":"string"}},{"name":"status","in":"query","description":"Filter by status","required":false,"schema":{"type":"string","enum":["SUCCESS","NETWORK_ERROR","PARSING_ERROR","COMIC_UNAVAILABLE","AUTHENTICATION_ERROR","STORAGE_ERROR","UNKNOWN_ERROR"]}},{"name":"fromDate","in":"query","description":"Filter by from date (inclusive, within the 7-day window)","required":false,"schema":{"type":"string","format":"date"}},{"name":"toDate","in":"query","description":"Filter by to date (inclusive, within the 7-day window)","required":false,"schema":{"type":"string","format":"date"}},{"name":"limit","in":"query","description":"Maximum number of records to return","required":false,"schema":{"type":"integer","format":"int32","default":100}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListComicRetrievalRecord"}}}}}},"delete":{"tags":["Retrieval Status"],"summary":"Purge all retrieval records older than specified days","operationId":"purgeOldRecords","parameters":[{"name":"daysToKeep","in":"query","description":"Days to keep (default is 7)","required":false,"schema":{"type":"integer","format":"int32","default":7}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseString"}}}}}}},"/api/v1/retrieval-status/{recordId}":{"get":{"tags":["Retrieval Status"],"summary":"Get a specific retrieval record by ID","operationId":"getRetrievalRecord","parameters":[{"name":"recordId","in":"path","description":"Record ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseComicRetrievalRecord"}}}}}},"delete":{"tags":["Retrieval Status"],"summary":"Delete a specific retrieval record","operationId":"deleteRetrievalRecord","parameters":[{"name":"recordId","in":"path","description":"Record ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseString"}}}}}}},"/api/v1/retrieval-status/summary":{"get":{"tags":["Retrieval Status"],"summary":"Get summary statistics of retrieval operations","description":"Returns aggregated statistics for all retrieval operations. Date parameters are optional and will further filter results within the available 7-day window.","operationId":"getRetrievalSummary","parameters":[{"name":"fromDate","in":"query","description":"Filter by from date (inclusive, within the 7-day window)","required":false,"schema":{"type":"string","format":"date"}},{"name":"toDate","in":"query","description":"Filter by to date (inclusive, within the 7-day window)","required":false,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseObject"}}}}}}},"/api/v1/retrieval-status/comics/{comicName}":{"get":{"tags":["Retrieval Status"],"summary":"Get retrieval records for a specific comic","operationId":"getRetrievalRecordsForComic","parameters":[{"name":"comicName","in":"path","description":"Comic name","required":true,"schema":{"type":"string"}},{"name":"limit","in":"query","description":"Maximum number of records to return","required":false,"schema":{"type":"integer","format":"int32","default":20}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListComicRetrievalRecord"}}}}}}},"/api/v1/preferences":{"get":{"tags":["preference-controller"],"operationId":"getPreferences","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseUserPreference"}}}}}}},"/api/v1/metrics/storage":{"get":{"tags":["metrics-controller"],"operationId":"getStorageMetrics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseImageCacheStats"}}}}}}},"/api/v1/metrics/storage/refresh":{"get":{"tags":["metrics-controller"],"operationId":"refreshStorageMetrics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseImageCacheStats"}}}}}}},"/api/v1/metrics/combined":{"get":{"tags":["metrics-controller"],"operationId":"getCombinedMetrics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringCombinedMetricsDto"}}}}}}},"/api/v1/metrics/access":{"get":{"tags":["metrics-controller"],"operationId":"getAccessMetrics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringAccessMetricsDto"}}}}}}},"/api/v1/health":{"get":{"tags":["Health"],"summary":"Get application health status","description":"Returns the current health status of the application, optionally with detailed metrics","operationId":"getHealthStatus","parameters":[{"name":"detailed","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"200":{"description":"Health status retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/v1/comics":{"get":{"tags":["comic-controller"],"operationId":"retrieveAllComics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListComicItem"}}}}}}},"/api/v1/comics/{comic}/strips/last":{"get":{"tags":["comic-controller"],"operationId":"retrieveLastComicImage","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ImageDto"}}}}}}},"/api/v1/comics/{comic}/strips/first":{"get":{"tags":["comic-controller"],"operationId":"retrieveFirstComicImage","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ImageDto"}}}}}}},"/api/v1/comics/{comic}/previous/{date}":{"get":{"tags":["comic-controller"],"operationId":"retrievePreviousComicImage","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"date","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ImageDto"}}}}}}},"/api/v1/comics/{comic}/next/{date}":{"get":{"tags":["comic-controller"],"operationId":"retrieveNextComicImage","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"date","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ImageDto"}}}}}}},"/api/v1/comics/{comic}/avatar":{"get":{"tags":["comic-controller"],"operationId":"retrieveAvatar","parameters":[{"name":"comic","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ImageDto"}}}}}}}},"components":{"schemas":{"User":{"type":"object","properties":{"username":{"type":"string"},"passwordHash":{"type":"string"},"email":{"type":"string"},"displayName":{"type":"string"},"created":{"type":"string","format":"date-time"},"lastLogin":{"type":"string","format":"date-time"},"roles":{"type":"array","items":{"type":"string"}},"userToken":{"type":"string","format":"uuid"}}},"ApiResponseUser":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/User"}}},"ApiResponseMapStringString":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object","additionalProperties":{"type":"string"}}}},"ApiResponseUserPreference":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/UserPreference"}}},"UserPreference":{"type":"object","properties":{"username":{"type":"string"},"favoriteComics":{"type":"array","items":{"type":"integer","format":"int32"}},"lastReadDates":{"type":"object","additionalProperties":{"type":"string","format":"date"}},"displaySettings":{"type":"object","additionalProperties":{}}}},"ComicItem":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"name":{"type":"string"},"author":{"type":"string"},"oldest":{"type":"string","format":"date"},"newest":{"type":"string","format":"date"},"enabled":{"type":"boolean"},"description":{"type":"string"},"avatarAvailable":{"type":"boolean"},"source":{"type":"string"},"sourceIdentifier":{"type":"string"}}},"ApiResponseComicItem":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/ComicItem"}}},"ApiResponseBoolean":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"boolean"}}},"UserRegistrationDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"email":{"type":"string"},"displayName":{"type":"string"}}},"ApiResponseAuthResponse":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/AuthResponse"}}},"AuthResponse":{"type":"object","properties":{"token":{"type":"string"},"refreshToken":{"type":"string"},"username":{"type":"string"},"displayName":{"type":"string"}}},"AuthRequest":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}},"ApiResponseString":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"string"}}},"ApiResponseListComicRetrievalRecord":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/ComicRetrievalRecord"}}}},"ComicRetrievalRecord":{"type":"object","properties":{"id":{"type":"string"},"comicName":{"type":"string"},"comicDate":{"type":"string","format":"date"},"source":{"type":"string"},"status":{"type":"string","enum":["SUCCESS","NETWORK_ERROR","PARSING_ERROR","COMIC_UNAVAILABLE","AUTHENTICATION_ERROR","STORAGE_ERROR","UNKNOWN_ERROR"]},"errorMessage":{"type":"string"},"retrievalDurationMs":{"type":"integer","format":"int64"},"imageSize":{"type":"integer","format":"int64"},"httpStatusCode":{"type":"integer","format":"int32"}}},"ApiResponseComicRetrievalRecord":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/ComicRetrievalRecord"}}},"ApiResponseObject":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{}}},"ApiResponseImageCacheStats":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/ImageCacheStats"}}},"ComicStorageMetrics":{"type":"object","properties":{"comicName":{"type":"string"},"storageBytes":{"type":"integer","format":"int64"},"imageCount":{"type":"integer","format":"int32"},"averageImageSize":{"type":"number","format":"double"},"mostRecentAccess":{"type":"string"},"accessCount":{"type":"integer","format":"int32"},"hitRatio":{"type":"number","format":"double"},"storageByYear":{"type":"object","additionalProperties":{"type":"integer","format":"int64"}},"downloadTime":{"type":"integer","format":"int64"}}},"ImageCacheStats":{"type":"object","properties":{"oldestImage":{"type":"string"},"newestImage":{"type":"string"},"years":{"type":"array","items":{"type":"string"}},"totalStorageBytes":{"type":"integer","format":"int64"},"perComicMetrics":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/ComicStorageMetrics"}}}},"ApiResponseMapStringCombinedMetricsDto":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/CombinedMetricsDto"}}}},"CombinedMetricsDto":{"type":"object","properties":{"comicName":{"type":"string"},"storageBytes":{"type":"integer","format":"int64"},"imageCount":{"type":"integer","format":"int32"},"averageImageSize":{"type":"number","format":"double"},"storageByYear":{"type":"object","additionalProperties":{"type":"integer","format":"int64"}},"accessCount":{"type":"integer","format":"int32"},"lastAccess":{"type":"string"},"averageAccessTime":{"type":"number","format":"double"},"hitRatio":{"type":"number","format":"double"}}},"AccessMetricsDto":{"type":"object","properties":{"comicName":{"type":"string"},"accessCount":{"type":"integer","format":"int32"},"lastAccess":{"type":"string"},"averageAccessTime":{"type":"number","format":"double"},"hitRatio":{"type":"number","format":"double"}}},"ApiResponseMapStringAccessMetricsDto":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/AccessMetricsDto"}}}},"ApiResponse":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{}}},"ApiResponseListComicItem":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/ComicItem"}}}},"ImageDto":{"type":"object","properties":{"mimeType":{"type":"string"},"imageData":{"type":"string"},"height":{"type":"integer","format":"int32"},"width":{"type":"integer","format":"int32"},"imageDate":{"type":"string","format":"date"}}}}}}