server.port=8888
#debug=true
spring.security.user.name=user
spring.security.user.password=voicebox1@
spring.output.ansi.enabled=always
spring.profiles.active=production

# Logging configuration for API endpoints
logging.level.web=INFO
logging.level.org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping=TRACE

# Shorten stack traces - exclude framework noise, keep app code visible (max 50 lines)
logging.exception-conversion-word=%wEx{50,org.springframework,org.apache,org.junit,org.gradle,java.lang.reflect,jdk.internal,sun.reflect,io.netty,worker.org.gradle}

# OpenAPI Configuration
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/v3/api-docs
springdoc.show-actuator=true
springdoc.swagger-ui.operationsSorter=method

# Spring Batch Job Configuration
# Disable auto-run of jobs on startup (jobs are scheduled via @Scheduled annotations)
spring.batch.job.enabled=false

# All jobs run in America/Toronto timezone
batch.timezone=America/Toronto

# Comic Download Job - Downloads all comics daily
batch.comic-download.enabled=true
batch.comic-download.cron=0 0 6 * * ?

# Comic Reconciliation Job - Reconciles comic configuration with bootstrap
batch.reconciliation.enabled=true
batch.reconciliation.cron=0 15 6 * * ?

# Metrics Archive Job - Archives yesterday's metrics to JSON
batch.metrics-archive.enabled=true
batch.metrics-archive.cron=0 30 6 * * ?

# Image Metadata Backfill Job - Backfills missing image metadata
batch.image-backfill.enabled=true
batch.image-backfill.cron=0 30 6 * * ?
batch.image-backfill.batch-size=100

# Metrics Update Job - Updates metrics every 5 minutes
batch.metrics-update.enabled=true
batch.metrics-update.fixed-delay=300000

# Retrieval Record Purge Job - Purges old retrieval records
batch.record-purge.enabled=true
batch.record-purge.cron=0 45 6 * * ?

# Comic Backfill Job - Backfills missing comics
batch.comic-backfill.enabled=true
batch.comic-backfill.cron=0 0 7 * * ?
batch.comic-backfill.chunk-size=10
batch.comic-backfill.max-consecutive-failures=3
batch.comic-backfill.delay-between-comics-ms=5000

# Global defaults for backfill limits
batch.comic-backfill.default-max-per-day=50
batch.comic-backfill.default-max-days-back=365

# Source-specific limits (override defaults)
# GoComics - allows deeper history
batch.comic-backfill.sources.gocomics.max-per-day=20
batch.comic-backfill.sources.gocomics.max-days-back=730

# Comics Kingdom - more limited history
batch.comic-backfill.sources.comicskingdom.max-per-day=10
batch.comic-backfill.sources.comicskingdom.max-days-back=180

# Batch execution tracking - JSON file location
batch.tracking.json-file=${comics.cache.location}/batch-executions.json

# Default cache location - will be normalized to appropriate OS path
# Windows: Uses C:/comics if drive exists, otherwise ~/comics
# Linux/macOS: Uses ~/comics if path starts with a drive letter, otherwise uses as-is
comics.cache.location=${COMICS_CACHE_LOCATION:C:/comics}
comics.cache.config=./comics.json
comics.cache.usersConfig=./users.json
comics.cache.preferencesConfig=./preferences.json
comics.cache.chromeHeadless=true
# Task execution tracker will store execution data in task-executions.json in the cache location

# JWT Configuration
jwt.secret=your-secret-key-should-be-very-long-and-secure-in-production-environment
jwt.expiration=900000
jwt.refresh-expiration=86400000

# Metrics Configuration
# Color detection: Percentage of pixels to sample for determining if image is B&W or color (0.0-100.0)
comics.metrics.color-detection.sample-percentage=5.0
# Error tracking: Maximum number of errors to keep per comic in last_errors.json
comics.metrics.error-tracking.max-errors-per-comic=5

# Caffeine Cache Configuration
# Enable/disable Caffeine caching
comics.cache.caffeine.enabled=true

# Navigation cache - stores ComicNavigationResult for comic strip navigation
comics.cache.caffeine.navigation.max-size=300
comics.cache.caffeine.navigation.ttl-minutes=10

# Boundary dates cache - stores newest/oldest dates for each comic
comics.cache.caffeine.boundary.max-size=100
comics.cache.caffeine.boundary.ttl-minutes=60

# Navigation dates cache - stores next/previous date lookup results
comics.cache.caffeine.navigation-dates.max-size=200
comics.cache.caffeine.navigation-dates.ttl-minutes=30

# Metadata cache - stores ComicItem configuration data
comics.cache.caffeine.metadata.max-size=60
comics.cache.caffeine.metadata.ttl-minutes=60

# Predictive lookahead cache configuration
comics.cache.caffeine.lookahead.enabled=false
comics.cache.caffeine.lookahead.count=3
